<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>{{ user.name }} | Professional Portfolio</title>
  <meta name="description" content="Professional portfolio of {{ user.name }}, AI Researcher, showcasing projects, publications, skills, and education.">
  <meta property="og:title" content="{{ user.name }} | Professional Portfolio">
  <meta property="og:description" content="Explore {{ user.name }}'s AI research, projects, and publications. Connect for collaboration or inquiries.">
  <meta property="og:image" content="{% if user.photo %}{{ user.photo.url }}{% else %}/static/images/default.png{% endif %}">
  <meta property="og:url" content="{{ request.build_absolute_uri }}">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?display=swap&family=Inter:wght@400;500;700;900&family=Noto+Sans:wght@400;500;700;900" rel="stylesheet">
  <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-XXXXXXXXXX"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'G-XXXXXXXXXX');
  </script>
  <style type="text/tailwindcss">
    :root {
      --primary-color: #1173d4;
      --secondary-color: #50E3C2;
      --accent-color: #F5A623;
    }
    .group:hover .group-hover\:text-primary {
      color: var(--primary-color);
    }
    .group:hover .group-hover\:fill-primary {
      fill: var(--primary-color);
    }
    .laptop-video-container {
      position: relative;
      width: 100%;
      padding-top: 56.25%;
    }
    .laptop-video {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      object-fit: cover;
    }
    .portfolio-content-overlay {
      position: absolute;
      top: 6.5%;
      left: 12.5%;
      width: 75%;
      height: 82%;
      overflow-y: auto;
    }
    .portfolio-content-overlay::-webkit-scrollbar {
      width: 8px;
    }
    .portfolio-content-overlay::-webkit-scrollbar-track {
      background: #1a1f25;
    }
    .portfolio-content-overlay::-webkit-scrollbar-thumb {
      background-color: #3e4a57;
      border-radius: 4px;
      border: 2px solid #1a1f25;
    }
    .portfolio-content-overlay::-webkit-scrollbar-thumb:hover {
      background-color: #556270;
    }
    .skill-badge {
      transition: transform 0.3s ease, box-shadow 0.3s ease;
    }
    .skill-badge:hover {
      transform: scale(1.15);
      box-shadow: 0 4px 12px rgba(0,0,0,0.1);
    }
  </style>
</head>
<body class="bg-gray-900 text-gray-200" style='font-family: Inter, "Noto Sans", sans-serif;'>
<div class="relative flex h-screen w-full flex-col items-center justify-center bg-[#111418] dark group/design-root overflow-hidden">
  <div class="laptop-video-container">
    <video autoplay class="laptop-video" loop muted playsinline>
      <source src="https://storage.googleapis.com/pixelverse-public/template-assets/videos/laptop-mockup.mp4" type="video/mp4">
    </video>
    <div class="portfolio-content-overlay">
      <div class="h-full w-full bg-[#111418]">
        <div class="layout-container flex h-full grow flex-col">
          <!-- Navigation -->
          <header class="sticky top-0 z-20 flex items-center justify-between whitespace-nowrap border-b border-solid border-b-[#283039] bg-[#111418]/80 px-10 py-4 backdrop-blur-sm">
            <div class="flex items-center gap-4 text-white">
              <a class="flex items-center gap-3 group" href="#">
                <svg class="h-6 w-6 text-[var(--primary-color)]" fill="none" viewBox="0 0 48 48" xmlns="http://www.w3.org/2000/svg">
                  <g clip-path="url(#clip0_6_319)">
                    <path d="M8.57829 8.57829C5.52816 11.6284 3.451 15.5145 2.60947 19.7452C1.76794 23.9758 2.19984 28.361 3.85056 32.3462C5.50128 36.3314 8.29667 39.7376 11.8832 42.134C15.4698 44.5305 19.6865 45.8096 24 45.8096C28.3135 45.8096 32.5302 44.5305 36.1168 42.134C39.7033 39.7375 42.4987 36.3314 44.1494 32.3462C45.8002 28.361 46.2321 23.9758 45.3905 19.7452C44.549 15.5145 42.4718 11.6284 39.4217 8.57829L24 24L8.57829 8.57829Z" fill="currentColor"></path>
                  </g>
                  <defs>
                    <clipPath id="clip0_6_319">
                      <rect fill="white" height="48" width="48"></rect>
                    </clipPath>
                  </defs>
                </svg>
                <h2 class="text-white text-xl font-bold leading-tight tracking-[-0.015em]">{{ user.name }}</h2>
              </a>
            </div>
            <nav class="flex items-center gap-8">
              <a class="text-gray-300 hover:text-[var(--primary-color)] text-sm font-medium transition-colors" href="#home">Home</a>
              <a class="text-gray-300 hover:text-[var(--primary-color)] text-sm font-medium transition-colors" href="#about">About</a>
              <a class="text-gray-300 hover:text-[var(--primary-color)] text-sm font-medium transition-colors" href="#skills">Skills</a>
              <a class="text-gray-300 hover:text-[var(--primary-color)] text-sm font-medium transition-colors" href="#education">Education</a>
              <a class="text-gray-300 hover:text-[var(--primary-color)] text-sm font-medium transition-colors" href="#projects">Projects</a>
              <a class="text-gray-300 hover:text-[var(--primary-color)] text-sm font-medium transition-colors" href="#publications">Publications</a>
              <a class="text-gray-300 hover:text-[var(--primary-color)] text-sm font-medium transition-colors" href="#videos">Videos</a>
              <a class="flex min-w-[84px] max-w-[480px] cursor-pointer items-center justify-center overflow-hidden rounded-md h-10 px-4 bg-[var(--primary-color)] text-white text-sm font-bold leading-normal tracking-wide shadow-lg hover:bg-opacity-90 transition-colors" href="#feedback">Let's Talk</a>
            </nav>
          </header>
          <main class="flex-1 px-10">
            <div class="mx-auto max-w-5xl py-16">
              <!-- Header -->
              <section class="flex flex-col items-center justify-center text-center py-20" id="home">
                <div class="bg-center bg-no-repeat aspect-square bg-cover rounded-full min-h-40 w-40 mb-6 border-4 border-gray-700 shadow-lg" style="{% if user.photo %}background-image: url('{{ user.photo.url }}');{% else %}background-image: url('/static/images/default.png');{% endif %}"></div>
                <h1 class="text-white text-5xl font-bold leading-tight tracking-tighter">{{ user.name }}</h1>
                <p class="text-[#9dabb9] text-xl font-normal leading-normal mt-2">AI Researcher</p>
              </section>
              <!-- About -->
              <section class="py-16 scroll-mt-20" id="about">
                <h2 class="text-white text-3xl font-bold leading-tight tracking-tight mb-8">ðŸ™‹ About Me</h2>
                <p class="text-gray-300 text-lg font-normal leading-relaxed {% if not user.bio %}italic text-gray-500{% endif %}">
                  {{ user.bio|default:"No bio available yet. Please update the profile in the admin panel." }}
                </p>
                <div class="flex justify-center gap-4 mt-6">
                  {% if user.twitter %}
                    <a href="{{ user.twitter }}" target="_blank" class="text-white bg-[#1DA1F2] p-3 rounded-full hover:scale-110 transition-transform" aria-label="Follow {{ user.name }} on Twitter" data-bs-toggle="tooltip" data-bs-placement="top" title="Follow on Twitter"><i class="fab fa-twitter"></i></a>
                  {% endif %}
                  {% if user.facebook %}
                    <a href="{{ user.facebook }}" target="_blank" class="text-white bg-[#1877F2] p-3 rounded-full hover:scale-110 transition-transform" aria-label="Follow {{ user.name }} on Facebook" data-bs-toggle="tooltip" data-bs-placement="top" title="Follow on Facebook"><i class="fab fa-facebook-f"></i></a>
                  {% endif %}
                  {% if user.linkedin %}
                    <a href="{{ user.linkedin }}" target="_blank" class="text-white bg-[#0A66C2] p-3 rounded-full hover:scale-110 transition-transform" aria-label="Connect with {{ user.name }} on LinkedIn" data-bs-toggle="tooltip" data-bs-placement="top" title="Connect on LinkedIn"><i class="fab fa-linkedin-in"></i></a>
                  {% endif %}
                  {% if user.instagram %}
                    <a href="{{ user.instagram }}" target="_blank" class="text-white bg-[#E1306C] p-3 rounded-full hover:scale-110 transition-transform" aria-label="Follow {{ user.name }} on Instagram" data-bs-toggle="tooltip" data-bs-placement="top" title="Follow on Instagram"><i class="fab fa-instagram"></i></a>
                  {% endif %}
                </div>
                {% if user.resume %}
                  <a href="{{ user.resume.url }}" class="mt-6 inline-flex items-center justify-center rounded-md border-2 border-[var(--primary-color)] text-[var(--primary-color)] font-semibold py-2 px-4 hover:bg-[var(--primary-color)] hover:text-white transition-all" download onclick="gtag('event', 'download_resume', { 'event_category': 'engagement', 'event_label': 'Resume Download' });">Download Resume <i class="fas fa-download ml-2"></i></a>
                {% endif %}
              </section>
              <!-- Skills -->
              <section class="py-16 scroll-mt-20" id="skills">
                <h2 class="text-white text-3xl font-bold leading-tight tracking-tight mb-8">âš¡ Core Competencies</h2>
                <div class="flex flex-wrap gap-3">
                  {% for skill in skills %}
                    <span class="skill-badge text-white text-sm font-medium py-2 px-4 rounded-full {{ skill.name|lower|slugify }} bg-[var(--secondary-color)] hover:bg-opacity-90">{{ skill.name }}</span>
                  {% empty %}
                    <p class="text-gray-500">No skills listed yet.</p>
                  {% endfor %}
                </div>
              </section>
              <!-- Education -->
              <section class="py-16 scroll-mt-20" id="education">
                <h2 class="text-white text-3xl font-bold leading-tight tracking-tight mb-8">ðŸŽ“ Education</h2>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                  {% for education in educations %}
                    <div class="flex flex-col gap-4 bg-[#1a1f25] rounded-lg p-6 shadow-lg transform hover:-translate-y-1 transition-transform duration-300">
                      <h3 class="text-white text-xl font-semibold">{{ education.degree }}</h3>
                      <p class="text-[#9dabb9] text-base">{{ education.start_year }} - {{ education.end_year|default:"Present" }}</p>
                      <p class="text-gray-300 text-base">{{ education.institute }}</p>
                    </div>
                  {% empty %}
                    <p class="text-gray-500">No education records available at this time.</p>
                  {% endfor %}
                </div>
              </section>
              <!-- Projects -->
              <section class="py-16 scroll-mt-20" id="projects">
                <h2 class="text-white text-3xl font-bold leading-tight tracking-tight mb-8">ðŸ’» Professional Projects</h2>
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
                  {% for project in projects %}
                    <div class="flex flex-col gap-4 bg-[#1a1f25] rounded-lg overflow-hidden shadow-lg transform hover:-translate-y-1 transition-transform duration-300">
                      {% if project.image %}
                        <div class="w-full bg-center bg-no-repeat aspect-video bg-cover" style="background-image: url('{{ project.image.url }}');"></div>
                      {% endif %}
                      <div class="p-6">
                        <h3 class="text-white text-xl font-semibold">{{ project.title }}</h3>
                        <p class="text-[#9dabb9] text-base mt-2 line-clamp-3">{{ project.description }}</p>
                        {% if project.language %}
                          <p class="text-[#9dabb9] text-sm mt-2">Made with: {{ project.language }}</p>
                        {% endif %}
                        {% if project.link %}
                          <a href="{{ project.link }}" target="_blank" class="inline-flex items-center mt-4 rounded-md bg-[var(--secondary-color)] text-white font-semibold py-2 px-4 hover:bg-opacity-90">View Project <i class="fas fa-external-link-alt ml-2"></i></a>
                        {% endif %}
                      </div>
                    </div>
                  {% empty %}
                    <p class="text-gray-500">No projects available at this time.</p>
                  {% endfor %}
                </div>
              </section>
              <!-- Publications -->
              <section class="py-16 scroll-mt-20" id="publications">
                <h2 class="text-white text-3xl font-bold leading-tight tracking-tight mb-8">ðŸ“š Research Publications</h2>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                  {% for pub in publications %}
                    <div class="flex flex-col gap-4 bg-[#1a1f25] rounded-lg overflow-hidden shadow-lg transform hover:-translate-y-1 transition-transform duration-300">
                      {% if pub.image %}
                        <div class="w-full bg-center bg-no-repeat aspect-video bg-cover" style="background-image: url('{{ pub.image.url }}');"></div>
                      {% endif %}
                      <div class="p-6">
                        <span class="inline-block bg-[var(--primary-color)] text-white text-sm font-medium py-1 px-3 rounded-full mb-2">PUBLISHED</span>
                        <h3 class="text-white text-xl font-semibold">{{ pub.title }}</h3>
                        <p class="text-[#9dabb9] text-base mt-2">{{ pub.journal }}<br>{{ pub.date|date:"F Y" }}</p>
                        <p class="text-[#9dabb9] text-base mt-2 line-clamp-3">{{ pub.description }}</p>
                        {% if pub.link %}
                          <a href="{{ pub.link }}" target="_blank" class="inline-flex items-center mt-4 rounded-md bg-[var(--primary-color)] text-white font-semibold py-2 px-4 hover:bg-opacity-90">Access Publication <i class="fas fa-external-link-alt ml-2"></i></a>
                        {% endif %}
                        <div class="flex flex-wrap gap-2 mt-4">
                          {% for tag in pub.get_tags_list %}
                            <a href="#" class="text-gray-400 bg-[#283039] text-sm font-medium py-1 px-3 rounded-full hover:bg-[#3e4a57] hover:text-[var(--primary-color)]">{{ tag }}</a>
                          {% endfor %}
                        </div>
                      </div>
                    </div>
                  {% empty %}
                    <p class="text-gray-500">No publications available at this time.</p>
                  {% endfor %}
                </div>
              </section>
              <!-- Videos -->
              <section class="py-16 scroll-mt-20" id="videos">
                <h2 class="text-white text-3xl font-bold leading-tight tracking-tight mb-8">ðŸŽ¥ Videos</h2>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                  {% for video in videos %}
                    <div class="flex flex-col gap-4 bg-[#1a1f25] rounded-lg overflow-hidden shadow-lg transform hover:-translate-y-1 transition-transform duration-300">
                      {% if video.get_youtube_id %}
                        <iframe class="w-full aspect-video rounded-t-lg" src="https://www.youtube.com/embed/{{ video.get_youtube_id }}" title="{{ video.title }}" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
                      {% else %}
                        <p class="text-gray-500 p-6">Invalid YouTube URL for {{ video.title }}</p>
                      {% endif %}
                      <div class="p-6">
                        <h3 class="text-white text-xl font-semibold">{{ video.title }}</h3>
                        <p class="text-[#9dabb9] text-base mt-2 line-clamp-3">{{ video.description|default:"No description available." }}</p>
                        <a href="{{ video.url }}" target="_blank" class="inline-flex items-center mt-4 rounded-md bg-[#FF0000] text-white font-semibold py-2 px-4 hover:bg-opacity-90">Watch on YouTube <i class="fas fa-external-link-alt ml-2"></i></a>
                      </div>
                    </div>
                  {% empty %}
                    <p class="text-gray-500">No videos available at this time.</p>
                  {% endfor %}
                </div>
              </section>
              <!-- Feedback -->
              <section class="py-16 scroll-mt-20" id="feedback">
                <h2 class="text-white text-3xl font-bold leading-tight tracking-tight mb-8">ðŸ’¬ Contact Me</h2>
                {% if messages %}
                  {% for message in messages %}
                    <div class="bg-red-900 text-red-200 border border-red-700 rounded-lg p-4 mb-4 flex justify-between items-center">
                      {{ message }}
                      <button type="button" class="text-red-200 hover:text-red-100" data-bs-dismiss="alert" aria-label="Close"><i class="fas fa-times"></i></button>
                    </div>
                  {% endfor %}
                {% endif %}
                <form method="post" class="max-w-xl mx-auto space-y-6" id="feedback-form">
                  {% csrf_token %}
                  <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <label class="flex flex-col">
                      <span class="text-gray-300 text-sm font-medium mb-2">Name <span class="text-red-500">*</span></span>
                      {{ feedback_form.name }}
                      {% if feedback_form.name.errors %}
                        <div class="text-red-400 text-sm mt-1">{{ feedback_form.name.errors|join:", " }}</div>
                      {% endif %}
                    </label>
                    <label class="flex flex-col">
                      <span class="text-gray-300 text-sm font-medium mb-2">Email <span class="text-red-500">*</span></span>
                      {{ feedback_form.email }}
                      {% if feedback_form.email.errors %}
                        <div class="text-red-400 text-sm mt-1">{{ feedback_form.email.errors|join:", " }}</div>
                      {% endif %}
                    </label>
                  </div>
                  <label class="flex flex-col">
                    <span class="text-gray-300 text-sm font-medium mb-2">WhatsApp (with country code, e.g., +12025550123, optional)</span>
                    {{ feedback_form.whatsapp }}
                    {% if feedback_form.whatsapp.errors %}
                      <div class="text-red-400 text-sm mt-1">{{ feedback_form.whatsapp.errors|join:", " }}</div>
                    {% endif %}
                  </label>
                  <label class="flex flex-col">
                    <span class="text-gray-300 text-sm font-medium mb-2">Message <span class="text-red-500">*</span></span>
                    {{ feedback_form.message }}
                    {% if feedback_form.message.errors %}
                      <div class="text-red-400 text-sm mt-1">{{ feedback_form.message.errors|join:", " }}</div>
                    {% endif %}
                  </label>
                  <div class="flex justify-end">
                    <button type="submit" class="flex min-w-[120px] cursor-pointer items-center justify-center rounded-md h-12 px-6 bg-[var(--primary-color)] hover:bg-[#0f63b8] text-white text-base font-bold leading-normal tracking-wide transition-colors duration-300" id="submit-btn">
                      <span class="truncate">Submit</span>
                      <span class="spinner hidden ml-2"><i class="fas fa-spinner fa-spin"></i></span>
                    </button>
                  </div>
                </form>
              </section>
            </div>
          </main>
          <!-- Footer -->
          <footer class="text-center py-8 bg-[#111418]/80 border-t border-[#283039] text-gray-400">
            <p>&copy; {{ user.name }} 2025. All Rights Reserved.</p>
            <div class="flex justify-center gap-4 mt-4">
              {% if user.twitter %}
                <a href="{{ user.twitter }}" target="_blank" class="text-gray-400 hover:text-[var(--primary-color)] transition-colors" aria-label="Follow {{ user.name }} on Twitter" data-bs-toggle="tooltip" data-bs-placement="top" title="Follow on Twitter"><i class="fab fa-twitter"></i></a>
              {% endif %}
              {% if user.facebook %}
                <a href="{{ user.facebook }}" target="_blank" class="text-gray-400 hover:text-[var(--primary-color)] transition-colors" aria-label="Follow {{ user.name }} on Facebook" data-bs-toggle="tooltip" data-bs-placement="top" title="Follow on Facebook"><i class="fab fa-facebook-f"></i></a>
              {% endif %}
              {% if user.linkedin %}
                <a href="{{ user.linkedin }}" target="_blank" class="text-gray-400 hover:text-[var(--primary-color)] transition-colors" aria-label="Connect with {{ user.name }} on LinkedIn" data-bs-toggle="tooltip" data-bs-placement="top" title="Connect on LinkedIn"><i class="fab fa-linkedin-in"></i></a>
              {% endif %}
              {% if user.instagram %}
                <a href="{{ user.instagram }}" target="_blank" class="text-gray-400 hover:text-[var(--primary-color)] transition-colors" aria-label="Follow {{ user.name }} on Instagram" data-bs-toggle="tooltip" data-bs-placement="top" title="Follow on Instagram"><i class="fab fa-instagram"></i></a>
              {% endif %}
            </div>
          </footer>
        </div>
      </div>
    </div>
  </div>
</div>
<!-- Feedback Modal -->
<div class="modal fade" id="feedbackModal" tabindex="-1" aria-labelledby="feedbackModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered">
    <div class="modal-content bg-[#1a1f25] border-none rounded-lg shadow-lg">
      <div class="modal-header bg-[var(--primary-color)] text-white rounded-t-lg">
        <h5 class="modal-title" id="feedbackModalLabel">Feedback Status</h5>
        <button type="button" class="text-white hover:text-gray-200" data-bs-dismiss="modal" aria-label="Close"><i class="fas fa-times"></i></button>
      </div>
      <div class="modal-body text-gray-200" id="feedbackModalBody">
        Your feedback has been successfully submitted. I'll get back to you soon!
      </div>
      <div class="modal-footer border-t-0">
        <button type="button" class="rounded-md bg-[var(--primary-color)] text-white font-semibold py-2 px-4 hover:bg-[#0f63b8] transition-colors" data-bs-dismiss="modal">Close</button>
      </div>
    </div>
  </div>
</div>
<!-- Back to Top Button -->
<button id="back-to-top" class="fixed bottom-5 right-5 bg-[var(--primary-color)] text-white rounded-full p-3 hover:bg-[#0f63b8] transition-colors" style="display: none; z-index: 1000;">
  <i class="fas fa-arrow-up"></i>
</button>
<!-- Bootstrap JS -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
<script>
  // Initialize Bootstrap tooltips
  const tooltipTriggerList = document.querySelectorAll('[data-bs-toggle="tooltip"]');
  const tooltipList = [...tooltipTriggerList].map(tooltipTriggerEl => new bootstrap.Tooltip(tooltipTriggerEl));
  // Show/hide back-to-top button
  window.addEventListener('scroll', function() {
    const backToTop = document.getElementById('back-to-top');
    if (window.scrollY > 300) {
      backToTop.style.display = 'block';
    } else {
      backToTop.style.display = 'none';
    }
  });
  // Scroll to top on click
  document.getElementById('back-to-top').addEventListener('click', function() {
    window.scrollTo({ top: 0, behavior: 'smooth' });
  });
  // Highlight active nav link
  const sections = document.querySelectorAll('section[id]');
  const navLinks = document.querySelectorAll('nav a[href^="#"]');
  window.addEventListener('scroll', () => {
    let current = '';
    sections.forEach(section => {
      const sectionTop = section.offsetTop - 100;
      if (window.scrollY >= sectionTop) {
        current = section.getAttribute('id');
      }
    });
    navLinks.forEach(link => {
      link.classList.remove('text-[var(--primary-color)]');
      if (link.getAttribute('href').slice(1) === current) {
        link.classList.add('text-[var(--primary-color)]');
      }
    });
  });
  // Section fade-in animation
  const observer = new IntersectionObserver((entries) => {
    entries.forEach(entry => {
      if (entry.isIntersecting) {
        entry.target.classList.add('opacity-100', 'translate-y-0');
        entry.target.classList.remove('opacity-0', 'translate-y-5');
      }
    });
  }, { threshold: 0.1 });
  document.querySelectorAll('section').forEach(section => {
    section.classList.add('opacity-0', 'translate-y-5', 'transition-all', 'duration-500');
    observer.observe(section);
  });
  // Get CSRF token from form
  function getCsrfToken() {
    const token = document.querySelector('input[name="csrfmiddlewaretoken"]');
    return token ? token.value : '';
  }
  // AJAX form submission
  document.getElementById('feedback-form').addEventListener('submit', function(event) {
    event.preventDefault();
    const form = this;
    const submitBtn = document.getElementById('submit-btn');
    const modal = new bootstrap.Modal(document.getElementById('feedbackModal'));
    const modalBody = document.getElementById('feedbackModalBody');
    const modalTitle = document.getElementById('feedbackModalLabel');
    // Clear previous errors
    document.querySelectorAll('.text-red-400').forEach(el => el.remove());
    // Disable button and show spinner
    submitBtn.disabled = true;
    submitBtn.querySelector('.spinner').classList.remove('hidden');
    fetch(form.action || window.location.pathname, {
      method: 'POST',
      body: new FormData(form),
      headers: {
        'X-Requested-With': 'XMLHttpRequest',
        'X-CSRFToken': getCsrfToken()
      }
    })
    .then(response => {
      console.log('Response Status:', response.status);
      console.log('Response Headers:', [...response.headers.entries()]);
      if (!response.ok) {
        throw new Error(`HTTP error! Status: ${response.status}`);
      }
      return response.text().then(text => {
        try {
          return JSON.parse(text);
        } catch (e) {
          console.error('JSON Parse Error:', e, 'Response Text:', text);
          return { success: response.status === 200, rawResponse: text };
        }
      });
    })
    .then(data => {
      submitBtn.disabled = false;
      submitBtn.querySelector('.spinner').classList.add('hidden');
      console.log('Response Data:', data);
      if (data.success === true || data.success === "true") {
        form.reset();
        modalTitle.textContent = 'Thank You!';
        modalBody.innerHTML = 'Your feedback has been successfully submitted. I\'ll get back to you soon!';
        modal.show();
      } else if (data.errors) {
        const errors = JSON.parse(data.errors);
        for (const [field, errorList] of Object.entries(errors)) {
          const fieldEl = form.querySelector(`#id_${field}`);
          if (fieldEl) {
            const errorDiv = document.createElement('div');
            errorDiv.className = 'text-red-400 text-sm mt-1';
            errorDiv.textContent = errorList.map(e => e.message).join(', ');
            fieldEl.parentNode.appendChild(errorDiv);
          }
        }
        modalTitle.textContent = 'Submission Error';
        modalBody.innerHTML = '<div class="bg-red-900 text-red-200 border border-red-700 rounded-lg p-4">Please correct the errors in the form.</div>';
        modal.show();
      } else {
        modalTitle.textContent = 'Submission Error';
        modalBody.innerHTML = '<div class="bg-red-900 text-red-200 border border-red-700 rounded-lg p-4">Error: ' +
          (data.rawResponse ? 'Unexpected response: ' + data.rawResponse :
           'Invalid response from server') + '</div>';
        modal.show();
      }
    })
    .catch(error => {
      submitBtn.disabled = false;
      submitBtn.querySelector('.spinner').classList.add('hidden');
      console.error('Fetch Error:', error);
      modalTitle.textContent = 'Submission Error';
      modalBody.innerHTML = '<div class="bg-red-900 text-red-200 border border-red-700 rounded-lg p-4">An error occurred: ' + error.message + '. Please try again later.</div>';
      modal.show();
    });
  });
</script>
</body>
</html>
